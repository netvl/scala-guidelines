<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title></title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="../">

        <link rel="stylesheet" href="book.css">
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">

        <!-- MathJax -->
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>
    </head>
    <body class="light">
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = localStorage.getItem('theme');
            if (theme == null) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = localStorage.getItem('sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li class="affix"><a href="./introduction.html">Introduction</a></li><li><a href="./reference.html"><strong>1.</strong> Reference for code reviewers</a></li><li><a href="./code-style/main.html"><strong>2.</strong> General code style</a></li><li><ul class="section"><li><a href="./code-style/formatting-and-whitespace.html"><strong>2.1.</strong> Formatting and whitespace</a></li><li><a href="./code-style/naming.html"><strong>2.2.</strong> Naming</a></li><li><a href="./code-style/imports.html"><strong>2.3.</strong> Imports</a></li><li><a href="./code-style/braces.html"><strong>2.4.</strong> Braces</a></li><li><a href="./code-style/comments.html"><strong>2.5.</strong> Comments</a></li></ul></li><li><a href="./type-system/main.html"><strong>3.</strong> Type system</a></li><li><ul class="section"><li><a href="./type-system/return-type-annotations.html"><strong>3.1.</strong> Return type annotations</a></li><li><a href="./type-system/structural-typing.html"><strong>3.2.</strong> Structural typing</a></li><li><a href="./type-system/generics-and-variance.html"><strong>3.3.</strong> Generics and variance</a></li><li><a href="./type-system/higher-kinded-types.html"><strong>3.4.</strong> Higher-kinded types</a></li><li><a href="./type-system/abstract-types.html"><strong>3.5.</strong> Abstract types</a></li><li><a href="./type-system/path-dependent-types.html"><strong>3.6.</strong> Path-dependent types</a></li><li><a href="./type-system/type-aliases.html"><strong>3.7.</strong> Type aliases</a></li><li><a href="./type-system/any-anyref-and-anyval.html"><strong>3.8.</strong> Any, AnyRef and AnyVal</a></li><li><a href="./type-system/isinstanceof-asinstanceof.html"><strong>3.9.</strong> isInstanceOf, asInstanceOf</a></li></ul></li><li><a href="./language-features/main.html"><strong>4.</strong> Language features</a></li><li><ul class="section"><li><a href="./language-features/implicits.html"><strong>4.1.</strong> Implicits</a></li><li><a href="./language-features/override-modifier.html"><strong>4.2.</strong> override modifier</a></li><li><a href="./language-features/abstract-override-modifier.html"><strong>4.3.</strong> abstract override modifier</a></li><li><a href="./language-features/pattern-matching.html"><strong>4.4.</strong> Pattern matching</a></li><li><a href="./language-features/multiple-parameter-lists.html"><strong>4.5.</strong> Multiple parameter list</a></li><li><a href="./language-features/symbolic-methods-and-infix-and-postfix-notation.html"><strong>4.6.</strong> Symbolic methods and infix and postfix notation</a></li><li><a href="./language-features/apply-method-on-classes.html"><strong>4.7.</strong> Apply method on classes</a></li><li><a href="./language-features/call-by-name.html"><strong>4.8.</strong> Call by name</a></li><li><a href="./language-features/return-statements.html"><strong>4.9.</strong> Return statements</a></li><li><a href="./language-features/macros.html"><strong>4.10.</strong> Macros</a></li><li><a href="./language-features/exception-handling.html"><strong>4.11.</strong> Exception handling</a></li><li><a href="./language-features/operation-chains.html" class="active"><strong>4.12.</strong> Operation chains</a></li><li><a href="./language-features/operations-nesting-and-for-comprehensions.html"><strong>4.13.</strong> Operations nesting and for comprehensions</a></li><li><a href="./language-features/string-interpolation.html"><strong>4.14.</strong> String interpolation</a></li><li><a href="./language-features/tuples.html"><strong>4.15.</strong> Tuples</a></li></ul></li><li><a href="./patterns-and-architecture/main.html"><strong>5.</strong> Patterns and architecture</a></li><li><ul class="section"><li><a href="./patterns-and-architecture/cake-pattern.html"><strong>5.1.</strong> Cake pattern</a></li><li><a href="./patterns-and-architecture/type-classes.html"><strong>5.2.</strong> Type classes</a></li><li><a href="./patterns-and-architecture/error-handling.html"><strong>5.3.</strong> Error handling</a></li><li><a href="./patterns-and-architecture/functional-programming.html"><strong>5.4.</strong> Functional programming</a></li><li><a href="./patterns-and-architecture/object-oriented-programming.html"><strong>5.5.</strong> Object-oriented programming</a></li><li><a href="./patterns-and-architecture/domain-specific-languages.html"><strong>5.6.</strong> Domain-specific languages</a></li></ul></li><li><a href="./libraries/main.html"><strong>6.</strong> Libraries</a></li><li><ul class="section"><li><a href="./libraries/collections.html"><strong>6.1.</strong> Collections</a></li><li><a href="./libraries/concurrency.html"><strong>6.2.</strong> Concurrency</a></li><li><a href="./libraries/other-scala-libraries.html"><strong>6.3.</strong> Other Scala libraries</a></li><li><a href="./libraries/java-libraries.html"><strong>6.4.</strong> Java libraries</a></li></ul></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush"></i>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <i id="print-button" class="fa fa-print" title="Print this book"></i>
                    </div>
                </div>

                <div id="content" class="content">
                    <h1>Operation chains</h1>
<p>Many of the standard and non-standard Scala types contain so-called monadic operators, most notable of them being <code>map</code>, <code>flatMap</code> and <code>filter</code>. Scala collections provide many more operations which can also be chained in the same way.</p>
<p>This is a very powerful tool which allows expressing complex patterns very concisely. However, precisely for this reason - because such chains allow the code to be very dense in terms of meaning per line of code - chaining should be used sparingly.</p>
<p>In general, follow these rules:</p>
<ol>
<li>
<p>Avoid chaining more than a few operations. The actual number will vary depending on the situation, but it usually should not be more than 5-7 operations at max. Split longer chains by creating temporary variables.</p>
</li>
<li>
<p>As a follow-up to the previous rule, the maximum number of chained operations heavily depends on the size of the code which is passed to the combinator functions. In other words, you should chain less operations if the lambdas you used are relatively large. The opposite does not hold, however: you shouldn't chain more operations just because your lambdas are small; while this may make sense depending on the situation, splitting chains and saving parts of expressions in separate variables is almost always a good thing.</p>
</li>
<li>
<p>As a rule of thumb, if understanding what a particular sequence of operations does takes more than 5-10 seconds, you should try to rewrite it in a simpler way.</p>
</li>
</ol>
<p>Here is an example copied from the Twitter's Effective Scala:</p>
<pre><code class="language-scala">val votes = Seq((&quot;scala&quot;, 1), (&quot;java&quot;, 4), (&quot;scala&quot;, 10), (&quot;scala&quot;, 1), (&quot;python&quot;, 10))
val orderedVotes = votes
  .groupBy(_._1)
  .map { case (which, counts) =&gt; 
    (which, counts.foldLeft(0)(_ + _._2))
  }.toSeq
  .sortBy(_._2)
  .reverse
</code></pre>
<p>This piece of code is incomprehensible to anyone except its original author, and even they will forget what they meant in a very short time. Splitting the chain in logical parts and avoiding tuple accessors in favor of using named parameters allows to make the code much clearer:</p>
<pre><code class="language-scala">val votesByLang = votes groupBy { case (lang, _) =&gt; lang }
val sumByLang = votesByLang map {
  case (lang, counts) =&gt;
    val countsOnly = counts map { case (_, count) =&gt; count }
    (lang, countsOnly.sum)
}
val orderedVotes = sumByLang.toSeq
  .sortBy { case (_, count) =&gt; count }
  .reverse
</code></pre>

                </div>

                <!-- Mobile navigation buttons -->
                
                    <a href="./language-features/exception-handling.html" class="mobile-nav-chapters previous">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="./language-features/operations-nesting-and-for-comprehensions.html" class="mobile-nav-chapters next">
                        <i class="fa fa-angle-right"></i>
                    </a>
                

            </div>

            
                <a href="./language-features/exception-handling.html" class="nav-chapters previous" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-left"></i>
                </a>
            

            
                <a href="./language-features/operations-nesting-and-for-comprehensions.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <!-- Livereload script (if served using the cli tool) -->
        

        <script src="highlight.js"></script>
        <script src="book.js"></script>
    </body>
</html>
